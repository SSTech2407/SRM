<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Student Record Manager</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="dashboard-home.css" />
</head>
<body>
  <!-- top-level anchors for CSS :target tab routing -->
  <a id="home" class="panel-anchor" aria-hidden="true"></a>
  <a id="add" class="panel-anchor" aria-hidden="true"></a>
  <a id="students" class="panel-anchor" aria-hidden="true"></a>
  <a id="attendance" class="panel-anchor" aria-hidden="true"></a>
  <a id="about" class="panel-anchor" aria-hidden="true"></a>
  <header class="site-header">
    <div class="container header-inner">
      <div class="brand">
        <img class="logo" src="education.png" alt="Education logo" width="44" height="44" />
        <div class="title-wrap">
          <h1 class="site-title">Student Record Manager</h1>
          <!-- <p class="site-sub">Modern, clean ERP-style student management UI</p> -->
        </div>
      </div>

      <nav class="main-nav" aria-label="Primary">
        <ul>
          <li><a href="#home" class="nav-link">Home</a></li>
          <li><a href="#add" class="nav-link">Add Student</a></li>
          <li><a href="#students" class="nav-link">View Students</a></li>
          <li><a href="#attendance" class="nav-link">Attendance</a></li>
          <li><a href="#about" class="nav-link">About</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container main">
    <!-- anchors for CSS-only tab targeting (top-level anchors are before header) -->

    <section id="add-student-panel" class="panel add-student" aria-labelledby="add-student-heading">
      <div class="panel-header">
        <h2 id="add-student-heading">Add Student</h2>
        <p class="muted">Enter student details to add a new record.</p>
      </div>

      <form class="form-grid" novalidate>
        <div class="form-group">
          <label for="name">Name</label>
          <input id="name" name="name" type="text" placeholder="e.g., Ananya Sharma" />
        </div>

        <div class="form-group">
          <label for="roll">Roll Number</label>
          <input id="roll" name="roll" type="text" placeholder="e.g., 2025-001" />
        </div>

        <div class="form-group">
          <label for="section">Section</label>
          <input id="section" name="section" type="text" placeholder="e.g., A / B" />
        </div>

        <div class="form-group">
          <label for="department">Department</label>
          <input id="department" name="department" type="text" placeholder="e.g., Science" />
        </div>

        <div class="form-group">
          <label for="course">Course</label>
          <input id="course" name="course" type="text" placeholder="e.g., Computer Science" />
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input id="email" name="email" type="email" placeholder="e.g., student@example.edu" />
        </div>

        <div class="form-group">
          <label for="phone">Phone Number</label>
          <input id="phone" name="phone" type="tel" placeholder="e.g., +91 98765 43210" />
        </div>

        <div class="form-group">
          <label for="year">Year of Admission</label>
          <input id="year" name="year" type="number" min="1900" max="2099" placeholder="e.g., 2025" />
        </div>

        <div class="form-group">
          <label for="semester">Semester</label>
          <input id="semester" name="semester" type="number" min="1" max="12" placeholder="e.g., 3" />
        </div>

        <div class="form-group" id="faceField">
          <label for="facePreviewImg">Face Registration</label>
          <div class="face-input-row">
            <img id="facePreviewImg" alt="Face preview" class="face-preview" src="face_icon.jpg" />
            <div class="face-actions">
              <button type="button" id="faceRegisterBtn" class="btn btn-ghost">Register Face</button>
              <input type="hidden" id="facePreviewData" name="facePreviewData" />
            </div>
          </div>
          <p class="muted" style="margin-top:6px">Capture a face snapshot to link with this student.</p>
        </div>

        <div class="form-actions" aria-hidden="false">
          <button type="submit" class="btn btn-primary">Submit</button>
          <button type="reset" class="btn btn-ghost">Reset</button>
        </div>
      </form>
    </section>

    <!-- Home panel: dashboard-style overview -->
    <section id="home-panel" class="panel home-panel" aria-labelledby="home-heading">
      <div class="dash-grid" aria-describedby="home-sub">
        <!-- Left column -->
        <div class="dash-left card" role="region" aria-labelledby="home-heading">
          <div class="welcome-block">
            <div class="welcome-icon" aria-hidden="true">ðŸŽ“</div>
            <div>
              <h2 id="home-heading">Welcome back, <span class="accent" id="teacher-name">Admin</span> ðŸ‘‹</h2>
              <p id="home-sub" class="muted">Use the scanner to mark attendance or review monthly reports below.</p>
            </div>
          </div>
          <div class="actions-row" role="group" aria-label="Quick actions">
            <button id="markAttendanceBtn" class="btn primary" type="button">Mark Attendance</button>
            <button id="openRegister" class="btn ghost" type="button">Register Face</button>
            <a href="#add" class="btn ghost" role="button">Add Student</a>
          </div>
          <div class="kpis" role="group" aria-label="Key performance indicators">
            <div class="kpi" aria-label="Total Students"><div class="muted">Total Students</div><div class="kpi-val" id="kpiStudents">â€”</div></div>
            <div class="kpi" aria-label="Today Present"><div class="muted">Today Present</div><div class="kpi-val" id="kpiToday">â€”</div></div>
            <div class="kpi" aria-label="Short Attendance"><div class="muted">Short Attendance</div><div class="kpi-val" id="kpiShort">â€”</div></div>
          </div>
        </div>
        <!-- Right column -->
        <div class="dash-right card" role="region" aria-labelledby="monthly-heading">
          <div class="panel-head monthly-head">
            <h3 id="monthly-heading">Monthly Attendance</h3>
          </div>
          <div class="controls monthly-controls" aria-label="Attendance range and threshold">
            <label for="rangeStart" class="muted">From</label>
            <input type="month" id="rangeStart" />
            <label for="rangeEnd" class="muted">To</label>
            <input type="month" id="rangeEnd" />
            <label for="threshold" class="muted">Threshold</label>
            <input type="number" id="threshold" min="0" max="100" value="75" />
            <button id="applyRange" class="btn" type="button">Apply</button>
          </div>
          <div class="chart-wrap">
            <canvas id="homeAttendanceChart" height="140" aria-label="Monthly average attendance chart" role="img"></canvas>
          </div>
        </div>
        <!-- Full width table -->
        <div class="full card table-card" role="region" aria-labelledby="short-att-heading">
          <div class="panel-head">
            <h3 id="short-att-heading">Short Attendance â€” Students below threshold</h3>
            <div class="muted">Shows students whose attendance % is below threshold for the selected range</div>
          </div>
          <div class="table-wrap">
            <table class="students-table" aria-label="Short attendance" role="table">
              <thead>
                <tr><th>Name</th><th>Roll</th><th>Dept</th><th>Attendance %</th><th>Action</th></tr>
              </thead>
              <tbody id="shortBody"><tr><td colspan="5" class="muted">Loadingâ€¦</td></tr></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

  <section id="records-panel" class="panel records" aria-labelledby="records-heading">
      <div class="panel-header records-header">
        <div>
          <h2 id="records-heading">Student Records</h2>
          <p class="muted">Browse and manage student data</p>
        </div>

        <div class="search-wrap">
          <label for="search" class="sr-only">Search students</label>
          <div class="search">
            <input id="search" type="search" placeholder="Search by name, roll number or section" />
            <button class="btn-icon" aria-label="Search (design only)">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="11" cy="11" r="6"></circle><path d="M21 21l-4.35-4.35"></path></svg>
            </button>
          </div>
        </div>
      </div>

      <div class="table-wrap">
        <table class="students-table" role="table" aria-label="Student records">
          <thead>
            <tr>
              <th scope="col">Name</th>
              <th scope="col">Roll Number</th>
              <th scope="col">Section</th>
              <th scope="col">Course</th>
              <th scope="col">Semester</th>
              <th scope="col" class="actions-col">Actions</th>
            </tr>
          </thead>
          <tbody id="studentsBody">
            <tr class="placeholder"><td colspan="6" class="muted">No students yet. Add a student to see them here.</td></tr>
          </tbody>
        </table>
      </div>

      <div class="table-footer">
        <div class="muted">Showing 1 of 1 records (design only)</div>
        <div class="pagination">
          <button class="page-btn" disabled>â€¹ Prev</button>
          <button class="page-btn active">1</button>
          <button class="page-btn" disabled>Next â€º</button>
        </div>
      </div>
    </section>

    <section id="about-panel" class="panel about-panel" aria-labelledby="about-heading">
      <div class="panel-header">
        <div>
          <h2 id="about-heading">About Student Record Manager</h2>
          <p class="muted">Modern, local-first attendance and student records dashboard</p>
        </div>
      </div>

      <div class="about-content">
        <p>Student Record Manager (SRM) helps institutes manage student details and track attendance with a clean, responsive UI. It works fully offline in the browser using IndexedDB, and can later connect to a backend for syncing.</p>

        <h3>Key Features</h3>
        <ul>
          <li>Add, view, edit, and delete student records</li>
          <li>Searchable student listing with quick filters</li>
          <li>Dashboard KPIs, monthly attendance chart, and short-attendance list</li>
          <li>Attendance scanner page prepared for face recognition</li>
          <li>Local-first storage via IndexedDB for offline usage</li>
        </ul>

        <h3>How It Works</h3>
        <ul>
          <li><strong>Tabs:</strong> Home, Add Student, View Students, Attendance, and About</li>
          <li><strong>Storage:</strong> Students and attendance logs are saved in your browser (IndexedDB)</li>
          <li><strong>Dashboard:</strong> Aggregates local data to render KPIs, charts, and short-attendance</li>
          <li><strong>Scanner:</strong> Uses camera (getUserMedia) and face-api.js for future face matching</li>
        </ul>

        <h3>Data & Privacy</h3>
        <ul>
          <li>All data stays on your device unless you add a backend to sync</li>
          <li>Clear data anytime by clearing the browserâ€™s site data for this app</li>
        </ul>

        <h3>Tech Stack</h3>
        <ul>
          <li>HTML, CSS, and vanilla JavaScript</li>
          <li>Chart.js for visualizations</li>
          <li>IndexedDB for local persistence</li>
          <li>face-api.js in the scanner (optional)</li>
        </ul>

        <h3>Next Steps</h3>
        <ul>
          <li>Connect to a backend (Node.js/Express) for multi-device sync</li>
          <li>Finalize face registration/matching and auto-mark attendance</li>
          <li>Export/import data as CSV</li>
        </ul>
      </div>
    </section>
  </main>
  <footer class="site-footer">
    <div class="container">
      <div class="footer-inner">
        <div class="copyright">Â© 2025 Student Record Manager</div>
        <div class="footer-links">
          <a href="#">Privacy</a>
          <a href="#">Terms</a>
          <a href="#">Contact</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="notify.js"></script>
  <script src="local-db.js"></script>
  <script src="app.js" defer></script>
  <script src="view-students.js" defer></script>
  <script src="dashboard-home.js" defer></script>
  
  <!-- Reusable modal for viewing student details -->
  <div id="studentModal" class="modal" hidden>
    <div class="modal-backdrop"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="studentModalTitle">
      <div class="modal-head">
        <h3 id="studentModalTitle">Student Details</h3>
        <button class="modal-close" aria-label="Close">âœ•</button>
      </div>
      <div id="studentModalBody" class="modal-body"></div>
      <div class="modal-foot">
        <button id="modalCloseBtn" class="btn">Close</button>
      </div>
    </div>
  </div>

  <!-- Face Capture Modal -->
  <div id="capModal" class="cap-modal" hidden>
    <div class="cap-backdrop" aria-hidden="true"></div>
    <div class="cap-card" role="dialog" aria-modal="true" aria-labelledby="capTitle">
      <div class="cap-head">
        <h3 id="capTitle">Register Face</h3>
        <button id="capClose" class="cap-close" aria-label="Close">âœ•</button>
      </div>
      <div class="cap-sub muted">Center your face, ensure good lighting and a neutral expression.</div>
      <div class="cap-body">
        <div class="cap-stage">
          <video id="capVideo" playsinline autoplay muted></video>
          <img id="capPreview" alt="Captured preview" />
        </div>
        <div class="cap-side">
          <div class="muted" style="margin-bottom:12px">Center your face, ensure good lighting and a neutral expression.</div>
          <div class="cap-controls">
            <button id="capCapture" class="btn btn-primary" type="button">Capture</button>
            <button id="capRetake" class="btn" type="button" hidden>Retake</button>
            <button id="capUse" class="btn" type="button" hidden>Use Photo</button>
            <button id="capCancel" class="btn btn-ghost" type="button">Cancel</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>